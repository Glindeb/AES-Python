% Document class and packages
\documentclass[a4paper, 12pt]{report}
\usepackage{geometry}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage{fontenc}
\usepackage{float}
\usepackage[swedish]{babel}
% For headers and footers
\usepackage{fancyhdr, lastpage}
\usepackage{fancyvrb}
% Math spesific packages
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
% For reffereces displaying and coloring as well as for some document settings
\usepackage[]{hyperref}
% For math symbols and figures
\usepackage{tikz}
% For color boxes
\usepackage{xcolor}
\usepackage[most]{tcolorbox}
% For unit displaying
\usepackage{siunitx}
% For correct paragraph phrasing
\usepackage{parskip}

% For figure caption formatting
\usepackage[font=small,labelfont=bf,center]{caption}

% For correct fotnotes and citation structure
\usepackage[backend=bibtex8,style=verbose,citestyle=alphabetic,bibstyle=alphabetic]{biblatex}
\addbibresource{ref.bib}

% Background image of title page
\usepackage{eso-pic}
\newcommand\BackgroundIm{
\put(0,0){
\parbox[b][\paperheight]{\paperwidth}{
\vfill
\centering
\includegraphics[height=\paperheight,width=\paperwidth,
keepaspectratio]{background-1.png}
\vfill
}}}

% To fix footnote counter between files
\usepackage{chngcntr}
\counterwithout*{footnote}{chapter}

% Global options
\geometry{a4paper}
\graphicspath{{Images/}}
\hypersetup{
  linkcolor=black,
  citecolor={blue!50!black},
  filecolor={blue!50!black},
  urlcolor={blue!80!black},
  pdftitle={The AES encryption algorithm},
  pdfauthor={Gabriel Lindeblad},
  pdfcreator={Gabriel Lindeblad},
  pdfsubject={Advanced Encryption Standard},
  pdfstartpage=1,
  pdffitwindow=true,
  colorlinks=true,
  pdfpagemode=UseNone,
  }
\setcounter{tocdepth}{3}
\setcounter{secnumdepth}{3}
\pagestyle{fancy}
\rhead{\currentchapter}
\cfoot{\thepage}
\fancyheadoffset[L, RO]{0cm}


% New commands and changed commands
\newcommand{\currentchapter}{}
\newcommand{\mychapter}[1]{\chapter{#1}
\renewcommand{\currentchapter}{#1}}
\renewcommand{\bibname}{Källförteckning}
\renewcommand{\contentsname}{Inehållsförteckning}
\renewcommand{\listfigurename}{Figurer}
\newcommand{\fakechapter}[2]{%
  \par\setcounter{chapter}{#2}
  \chaptermark{#1}
  \rhead{ }
}
\newcommand*{\captionsource}[2]{%
  \caption[{#1}]{%
    #1%
    \\\hspace{\linewidth}%
    \textbf{Källa:} #2%
  }%
}

% Titel reformating
\titleformat{\chapter}[block]
  {\normalfont\huge\bfseries}{\thechapter}{0.5em}{\Huge}
\titlespacing*{\chapter}{0pt}{-25pt}{0pt}

\titleformat{\section}[block]
  {\normalfont\Large\bfseries}{\thesection}{0.5em}{\Large}
\titlespacing*{\chapter}{0pt}{-25pt}{0pt}

\titleformat{\subsection}[block]
  {\normalfont\large\bfseries}{\thesubsection}{0.5em}{\large}
\titlespacing*{\chapter}{0pt}{-25pt}{0pt}

\titleformat{\subsubsection}[block]
  {\normalfont\normalsize\bfseries}{\thesubsubsection}{0.5em}{\normalsize}
\titlespacing*{\chapter}{0pt}{-25pt}{0pt}


% Glossaries setup
\usepackage[nopostdot,nonumberlist,style=super,acronym,toc]{glossaries}
\setlength{\glsdescwidth}{0.8\hsize}
\makeglossaries

\renewcommand*{\glossaryname}{Begreppförklaring}
\renewcommand*{\acronymname}{Akronymer}
\renewcommand{\glsnamefont}[1]{\textbf{#1}}

%%%
\newglossaryentry{rsa}
{
    name={RSA},
    description={Rivest-Shamir-Adleman (RSA) är en av de mest välkända krypteringsalgoritmerna
    och var en av de första algorithmerna som byggde på en asymetrisk kryptering.
    RSA bygger på multiplikation av stora primatal där primtalen är
    nycklarna.\cite{rsa-ref}}
 }

\newglossaryentry{caesar}
{
    name={Caesarchiffer},
    description={Caesarchiffer är ett \gls{substitutionsskiffer},
    vilket helt enkelt bygger på att man byter ut varje bokstav i
    medelandet med en annan. Ersättnings bokstaven bestäms genom
    att man hoppar ett visst antal hopp i alphabetet som exempelvis
    3 hopp, vilket då innebär att ifall man har bokstaven a då skulle
    den bli ett d istället.\cite{caesar}}
 }

\newglossaryentry{xor}
{
    name={XOR},
    symbol={\(\oplus\)},
    description={XOR är en logisk operation inom datorvetenskap som fungerar ungefär som + uttrycket,
    med den enda skillnaden att {\(1 \oplus 1 = 0\)}. Detta samt att xor är en \gls{binär} operation, vilket
    innebär att termerna bara kan vara 0 eller 1 och resultatet det samma. Utöver XOR finns även
    \gls{or}, \gls{not} och \gls{and} bland annat.\cite{xor}} % Maybe needs to be refined
 }

\newglossaryentry{python}
{
    name={Python},
    description={Python är ett högnivå programmerings språk byggt på programmerings språket C.
    De är skapat av Guido van Rossum och släpptes i Februari 1991.\cite{python}}
 }

 \newglossaryentry{keystream}
 {
     name={Nyckelström},
     description={En nyckelström är i kryptografin en ström av \gls{pseudoslump}
     karaktärer som kan kombineras med exempelvis ett medelande för att producera
     en skiffertext.\cite{keystream}}
  }

  \newglossaryentry{pseudoslump}
  {
      name={Pseudoslump},
      description={Pseudoslump är en rad av nummer som kan se ut att vara helt
      slumpmässiga men har blivit framställda genom en upprepbar process.\cite{pseudoslump}}
   }

  \newglossaryentry{vscode}
  {
      name={VSCode},
      description={Visual Studio Code är en programutveklingsmiljö som är skapad av Microsoft.
      Det är ett öppet källkods projekt som är tillgängligt för det flesta operativsystem
      och kan användas för att skriva kod i flera olika språk.\cite{vscode-ref}}
   }

  \newglossaryentry{streamcipher}
  {
      name={Strömskiffer},
      description={Strömskiffer, ett symetriskt nyckel skiffer där man använder en
      \gls{pseudoslump}mässig skiffer ström (\gls{keystream}) som sedan en \gls{bit} i taget
      kombineras med de som ska krypteras. Den kombinerande operationen som används i
      strömskiffer är ofta en \gls{xor}-operation.\cite{streamcipher-ref}}
   }

  \newglossaryentry{bit}
  {
       name={Bit},
       description={En Bit är den minsta enheten av information som kan lagras i en dator.
       En bit kan endast ha två värden där den antingen är 0 eller 1, alltså ett \gls{binär}t
       värde. I datorvetenskap pratar man dock mer vanligen om ett \gls{byte} som är 8 bits.\cite{bit-ref}}
   }

  \newglossaryentry{byte}
  {
      name={Byte},
      description={En Byte består av 8 \gls{bit}s och är en enhet som används inom
      datorvetenskap. En byte kan ha 256 olika värden från 0 till 255, vilket är $2^8$ värden.
      Dessa värden representerar ofta tecken eller symboler som exempelvis bokstäver, siffror med mera.
      Tolkningen av vad en sekvens av bytes eller en enskild byte står för beror däremot på vilken
      teckenkodning som används. Exempel på teckenkodningar kan var \acrshort{ascii} och ISO-8859.\cite{byte-ref}}
   }

  \newglossaryentry{hashfunktion}
  {
      name={Hashfunktion},
      description={Hashfunktion är en funktion som man kan säga delar upp en viss datamängd
      och genom för en serie operationer som resulterar i hashtext av godkännd längd.
      Längden är samma för alla hastexter som använder samma funktion medans innehållet
      förändras så fort något över huvud taget ändras i datan som funktionen appliceras på.
      Användningsområdet för dessa funktioner är bland annat när man vill kunna verifiera
      medelanden eller information och försäkra sig om att ingen ändrat på medellandet efter att de skickats.
      Detta kan man då göra för att man vet att om man skör informationen genom samma hashfunktion
      borde resultatet vara identisk ifall informationen är oförändrad.\cite{hashfunktion-ref}}
   }

  \newglossaryentry{polyalphabetic-substitutionsskiffer}
  {
      name={Polyalphabetic substitutionsskiffer},
      description={polyalphabetic substitutionsskiffer bygger på att man använder flera olika \gls{substitutionsskiffer} för att
      på så sätt undvika en ut av de största svagheterna med \gls{substitutionsskiffer}. Detta då att dom lätt går att
      knäcka genom en \gls{frekvensanalys} då vissa bokstäver dyker upp mer frekvent i språket än andra. För att lösa
      detta så använder polyalphabetiska skiffer flera olika substitutionsskiffer som man byter mellan med en viss
      frekvens för att eliminera \gls{frekvensanalys}ens effektivitet.\cite{polyalphabetic-ref}}
   }

  \newglossaryentry{frekvensanalys}
  {
    name={Frekvensanalys},
    description={Frekvensanalys inom kryptografi är en metod för att knäcka ett \gls{substitutionsskiffer} genom att
    analysera frekvensen av bokstäver och utnyttja de faktum att en del bokstäver framkommer mer frekvent än andra
    i språket. På detta viset kan man då sedan lista ut vilka bokstäver som är vilka i det krypterade medellandet.\cite{frekvensanalys-ref}}
    }

  \newglossaryentry{substitutionsskiffer}
  {
      name={Substitutionsskiffer}, % fix this
      description={Ett Substitutionsskiffer är en typ av krypterings metod som bygger på att man
      byter ut delar av informationen man ska kryptera med exempelvis andra symboler med hjälp av en nyckel.
      Detta kan exempelvis vara bokstäver som byts ut mot andra bokstäver precis som i \gls{caesar} eller
      siffror som byts ut mot andra siffror.\cite{substitutionsskiffer-ref}}
    }

  \newglossaryentry{and}
  {
      name={AND},
      description={AND är en logisk operation inom datorvetenskap och matematik
      som tar två \gls{binär}a värden och ger till baka ett \gls{binär}t värd. Detta värde
      är 1 om och endast om båda värdena är 1 annars är värdet 0.\cite{logical-operators-ref}}
    }

  \newglossaryentry{or}
  {
      name={OR},
      description={OR är en logisk operation inom datorvetenskap och matematik
      som tar två \gls{binär}a värden och ger till baka ett \gls{binär}t värd. Detta värde
      är 1 om minst ett av värdena är 1 annars är värdet 0.\cite{logical-operators-ref}}
    }

  \newglossaryentry{not}
  {
      name={NOT},
      description={NOT är en logisk operation inom datorvetenskap och matematik
      som tar två \gls{binär}a värden och jämför dom. Det slutgiltiga värdet som ges tillbaka är
      1 om värdena inte är lika varandra och annars är värdet 0.\cite{logical-operators-ref}}
    }

  \newglossaryentry{binär}
  {
      name={Binär},
      description={Binär är ett begrepp som används inom datorvetenskap och matematik för att beskriva
      ett värde som endast kan vara två olika saker som exempelvis 0 eller 1, sant eller falskt. Detta innebär abstract
      binära tal bygger på talbasen 2, vilket skiljer sig från vad som ofta vanligen används i vardagen
      som är talbasen 10.\cite{binär-ref}}
    }

  \newglossaryentry{enigma}
  {
      name={Enigma},
      description={Enigma var en...
        .\cite{enigma-ref}}
    }

\newacronym{aes}{AES}{Advanced Encryption Standard}
\newacronym{ecb}{ECB}{Electronic Code Book läge}
\newacronym{cbc}{CBC}{Cipher Block Chaining läge}
\newacronym{ofb}{OFB}{Output Feedback läge}
\newacronym{des}{DES}{Data Encryption Standard}
\newacronym{iv}{IV}{Initialization Vector}
\newacronym{ssl}{SSL}{Secure Socket Layer}
\newacronym{tls}{TLS}{Transport Layer Security}
\newacronym{ascii}{ASCII}{American Standard Code for Information Interchange}
%%%

% Start document
\begin{document}

\newgeometry{top=0cm, bottom=2cm, left = 1.5cm, right = 1.5cm}

% Beginning title page
\begin{titlepage}
    % Inserting background images
    \AddToShipoutPicture*{\BackgroundIm}

    % School logo
    \begin{figure}[H]
    \includegraphics[width=0.3\textwidth]{skola_logga.png}
    \end{figure}

    % Aligning year to the right
    \raggedleft

    % Year
    \vspace{-3.5cm}
    {\large \textbf{2022/2023}}

    % Aligning to the left
    \raggedright

    % Title and sub title
    \vspace{3.5cm}
	{\huge\bfseries The AES encryption algorithm\par}
   ~{\large En undersökning av The \acrfull{aes}}

% Bottom of the page
    \vfill

  {Klass:} \\
    ~\textbf{NA20}

  {Handledare:} \\
    ~\textbf{Jimmy Nylén}

  {Författare:} \\
    ~\textbf{Gabriel Lindeblad}

  {Program:} \\
    ~\textbf{Naturvetenskapsprogrammet}

    \vspace{1cm}
	{\large \today\par}
    \vspace{-1cm}

% End of title page
\end{titlepage}

% Geometry of page borders for abstract
\newgeometry{top=5cm, bottom=2cm, left = 2cm, right = 2cm}

% Abstract
\chapter*{Abstract}
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut lacinia ex eget sagittis congue.
Nullam cursus egestas dolor, suscipit gravida magna ultrices sit amet. Nullam placerat dui eu
arcu pharetra, sit amet tempor dolor convallis. Aenean sodales condimentum turpis, commodo maximus
augue. Aenean vel nibh dui. Pellentesque ex libero, lacinia nec mauris vel, convallis consectetur
felis. Maecenas ut nibh sed magna maximus imperdiet at id purus. In vel consequat metus. Donec non
tincidunt nunc. Sed pulvinar odio ut sapien vestibulum, quis mollis arcu tempor. Maecenas ut sem leo.
Sed leo risus, mollis eu ex vitae, feugiat consequat metus. Aenean interdum volutpat urna, nec
tempor mi accumsan quis. Morbi blandit maximus urna non aliquet aes.

% New page borders for bulk of the report
\newgeometry{top=2.5cm, bottom=2cm, left = 2cm, right = 2cm} % 2.25cm is the height of the header (is a checky solution that might need to bee removed if more headings are added)

% Inehållsförteckning
\tableofcontents

\clearpage

\printglossary

\printglossary[type=\acronymtype]

\include{Introduction}

\include{Bakgrund}

\include{Teori}

\include{Material_utförande}

\include{Resultat}

\include{Diskussion}

\fakechapter{Källförteckning}{7}
\addcontentsline{toc}{chapter}{Källförteckning}
\printbibliography[title=Källförteckning]

\clearpage

\fakechapter{Figurer}{8}
\addcontentsline{toc}{chapter}{Figurer}
\listoffigures

\begin{figure}
  \centering
  \includegraphics[width=0.6\textwidth]{pi.png}
  \caption{Orginal bild}
  \label{fig:pi-original}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.6\textwidth]{pi-ecb.png}
  \caption{Efter ECB Kryptering}
  \label{fig:pi-ecb}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.6\textwidth]{pi-cbc.png}
  \caption{Efter CBC Kryptering}
  \label{fig:pi-cbc}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.6\textwidth]{pi-OFB.png}
  \caption{Efter OFB Kryptering}
  \label{fig:pi-ofb}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.6\textwidth]{AES_(Rijndael)_Round_Function.png}
  \captionsource{Uppställning av vanliga rundor}{{\fullcite{rounds-picture}}}
  \label{fig:round-function}
\end{figure}

% End document
\end{document}